(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-ed4337c2"],{"4ec3":function(e,t,n){"use strict";n.d(t,"k",(function(){return i})),n.d(t,"e",(function(){return u})),n.d(t,"r",(function(){return s})),n.d(t,"p",(function(){return o})),n.d(t,"d",(function(){return c})),n.d(t,"j",(function(){return l})),n.d(t,"c",(function(){return p})),n.d(t,"i",(function(){return d})),n.d(t,"b",(function(){return f})),n.d(t,"h",(function(){return m})),n.d(t,"l",(function(){return h})),n.d(t,"q",(function(){return g})),n.d(t,"o",(function(){return v})),n.d(t,"n",(function(){return k})),n.d(t,"g",(function(){return b})),n.d(t,"a",(function(){return w})),n.d(t,"f",(function(){return y}));n("96cf");var r=n("1da1"),a=n("b775"),i=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/admin/task/tasks/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/admin/task/tasks/byauth/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].put("/api/admin/task/tasks/v/"+t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),o=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){var n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return n=t.id,e.next=3,a["a"].delete("/api/admin/task/tasks/e/"+n);case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),c=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/member");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),l=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/member/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),p=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/course");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),d=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/course/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),f=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/activity");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),m=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/activity/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].post("/api/u/activity",t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),g=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t,n){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].post("/api/u/activity/state/"+t,n);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t,n){return e.apply(this,arguments)}}(),v=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].delete("/api/u/activity/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),b=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/fdb/task");case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),w=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/fdb/task/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),k=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].delete("/api/u/fdb/task/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),y=function(){var e=Object(r["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,a["a"].get("/api/u/fdb/task/getFilename/"+t);case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()},5174:function(e,t,n){},"9f72":function(e,t,n){"use strict";n.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"update",attrs:{model:e.update,rules:e.updateRules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"负责人"}},[r("el-input",{model:{value:e.update.performer,callback:function(t){e.$set(e.update,"performer",t)},expression:"update.performer"}})],1),r("el-form-item",{attrs:{label:"任务说明"}},[r("el-input",{model:{value:e.update.title,callback:function(t){e.$set(e.update,"title",t)},expression:"update.title"}})],1),r("el-form-item",{attrs:{label:"任务详情"}},[r("el-input",{attrs:{type:"textarea"},model:{value:e.update.description,callback:function(t){e.$set(e.update,"description",t)},expression:"update.description"}})],1),r("el-form-item",{attrs:{label:"开始日期"}},[r("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.update.begintime,callback:function(t){e.$set(e.update,"begintime",t)},expression:"update.begintime"}})],1),r("el-form-item",{attrs:{label:"截止日期"}},[r("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.update.endtime,callback:function(t){e.$set(e.update,"endtime",t)},expression:"update.endtime"}})],1),r("el-form-item",{attrs:{label:"是否完成"}},[r("el-select",{attrs:{prop:"state"},model:{value:e.update.state,callback:function(t){e.$set(e.update,"state",t)},expression:"update.state"}},[r("el-option",{attrs:{label:"已完成",value:"1"}}),r("el-option",{attrs:{label:"未完成",value:"0"}})],1)],1),r("el-form-item",{attrs:{label:"任务可见",prop:"categoryid"}},[r("el-select",{model:{value:e.update.categoryid,callback:function(t){e.$set(e.update,"categoryid",t)},expression:"update.categoryid"}},[r("el-option",{attrs:{label:"全部人可见",value:"0"}}),r("el-option",{attrs:{label:"仅老师可见",value:"1"}})],1)],1),r("el-form-item",{attrs:{label:"附件"}},[r("el-row",e._l(this.file_list,(function(t){return r("el-col",{attrs:{span:8}},[r("div",{staticClass:"avatar-uploader"},[r("img",{attrs:{width:"40",height:"40",src:n("d284")("./"+e.matchType(t.filename)+".png")}}),r("p",[e._v(e._s(t.filename))])]),r("div",{staticClass:"mask"},[r("a",{attrs:{target:"_blank",title:"点击预览"},on:{click:function(n){return e.previewer(t.uuid)}}},[r("i",{staticClass:"el-icon-zoom-in"})]),r("a",{attrs:{title:"删除预览"},on:{click:function(n){return e.removeFile(t.uuid)}}},[r("i",{staticClass:"el-icon-delete"})]),r("a",{attrs:{title:"点击下载"},on:{click:function(n){return e.singeDownloadFile(t.uuid)}}},[r("i",{staticClass:"el-icon-download"})])])])})),1),r("el-row",[r("el-col",{attrs:{span:8}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"#",multiple:!0,"file-list":e.update.fileList,"auto-upload":!1}},[r("el-button",{attrs:{slot:"tip",size:"small",type:"primary"},on:{click:e.chooseFile},slot:"tip"},[e._v("选取文件 ")])],1)],1)],1)],1),r("el-form-item",[r("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateUser()}}},[e._v("确 定")])],1)],1)},a=[],i=(n("28a5"),n("7f7f"),n("a481"),n("2f62"),n("4ec3")),u=(n("b775"),function(e){var t=document.createElement("iframe");t.style.display="none",t.style.height=0,t.src=e,document.body.appendChild(t),setTimeout((function(){t.remove()}),3e5)}),s={name:"edit",data:function(){return{update:{id:"",nodeid:"",description:"",begintime:"",endtime:"",performer:"",title:"",state:"",isFile:0,fileList:[],categoryid:""},uploadFileURL:"",updateRules:{performer:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符"}],title:[{required:!0,message:"请输入任务名",trigger:"blur"},{min:1,max:25}]},isShowPdf:!1,PdfDownload:"javascript:;",file_list:[]}},activated:function(){var e=this.$store.state.duty.fileList;e&&e.length>0&&(this.update.fileList=e),this.getUser()},mounted:function(){this.getUser()},computed:{upData:function(){return{body:JSON.stringify(this.form)}}},methods:{submitUpload:function(){this.$refs.upload.submit(),this.getActivities()},previewer:function(e){window.open("/api/u/fdb/task/content/"+e,"_blank")},singeDownloadFile:function(e){var t=this;downloadNode().then((function(e){t.$message.success("成功下载")}))},chooseFile:function(){this.$router.push({path:"/task/attachments/new",query:{nodeid:this.update.nodeid}})},submit:function(){console.log("提交修改",this.update)},reset:function(){this.$refs.create.resetFields()},getUser:function(){var e=this,t=this;Object(i["k"])(t.$route.params.id).then((function(n){t.update=n,t.update.state=String(n["state"]),t.update.categoryid=String(n["categoryid"]),t.update.nodeid=n["nodeid"],t.uploadFileURL="/api/u/fdb/task/updatefile/"+n["nodeid"],null!=t.update.nodeid&&"None"!=t.update.nodeid&&(e.getFileName(),e.getFileLink("fileone"))}),(function(e){console.log(e)}))},updateUser:function(){var e=this;Object(i["r"])(this.$route.params.id,this.update).then((function(t){e.$message({message:"任务修改成功",type:"success"}),e.$router.push("/task/list")}))},handleCancel:function(){this.$router.replace("/task/list")},add:function(){this.$refs.upload.submit()},beforeImageUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传文件大小不能超过 20MB!"),t},upFile:function(e,t,n){var r=this;201==e.status&&(this.$message.success("上传成功"),r.update.nodeid=e.nodeid,this.getFileLink("fileone"),this.getFileName())},uploadFalse:function(e,t,n){this.$message.error(e.message.slice(1,-2))},handleExceed:function(e,t){this.$message.warning("当前只能选择上传2 个文件")},handleRemove:function(e,t,n){t&&"success"===t.status&&(this.$message.warning("移除当前".concat(e.name,"文件，请重新选择文件上传！")),this.removeFile("fileone"))},getFileLink:function(e){switch(this.fileDownloadPath="/api/u/fdb/task/"+this.update.nodeid,this.fileViewPath="/api/u/fdb/task/"+this.update.nodeid+"/content",e){case"fileone":this.PdfViewer=this.fileViewPath,this.PdfDownload=this.fileDownloadPath;break;case"filetwo":this.PdfViewerTwo=this.filePath;break}},getFileName:function(){var e=this;Object(i["f"])(this.update.nodeid).then((function(t){e.file_list=t,e.isShowPdf="没有附件"!=t}))},removeFile:function(e){var t=this;Object(i["n"])(e).then((function(e){t.getUser()}))},matchType:function(e){var t="",n="";try{var r=e.split(".");t=r[r.length-1]}catch(d){t=""}if(!t)return n=!1,n;var a=["png","jpg","jpeg","gif"];if(n=a.some((function(e){return e===t})),n)return n="image",n;var i=["txt"];if(n=i.some((function(e){return e===t})),n)return n="txt",n;var u=["pdf"];if(n=u.some((function(e){return e===t})),n)return n="pdf",n;var s=["doc","docx"];if(n=s.some((function(e){return e===t})),n)return n="doc",n;var o=["ppt","pptx"];if(n=o.some((function(e){return e===t})),n)return n="ppt",n;var c=["zip","rar"];if(n=c.some((function(e){return e===t})),n)return n="zip",n;var l=["mp4"];if(n=l.some((function(e){return e===t})),n)return n="mp4",n;var p=["xls","xlsx"];return n=p.some((function(e){return e===t})),n?(n="xls",n):void 0}}},o=s,c=(n("cac5"),n("2877"));n.d(t,"downloadFile",(function(){return u}));var l=Object(c["a"])(o,r,a,!1,null,null,null);t["default"]=l.exports},a481:function(e,t,n){"use strict";var r=n("cb7c"),a=n("4bf8"),i=n("9def"),u=n("4588"),s=n("0390"),o=n("5f1b"),c=Math.max,l=Math.min,p=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,f=/\$([$&`']|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};n("214f")("replace",2,(function(e,t,n,h){return[function(r,a){var i=e(this),u=void 0==r?void 0:r[t];return void 0!==u?u.call(r,i,a):n.call(String(i),r,a)},function(e,t){var a=h(n,e,this,t);if(a.done)return a.value;var p=r(e),d=String(this),f="function"===typeof t;f||(t=String(t));var v=p.global;if(v){var b=p.unicode;p.lastIndex=0}var w=[];while(1){var k=o(p,d);if(null===k)break;if(w.push(k),!v)break;var y=String(k[0]);""===y&&(p.lastIndex=s(d,i(p.lastIndex),b))}for(var x="",R=0,$=0;$<w.length;$++){k=w[$];for(var j=String(k[0]),O=c(l(u(k.index),d.length),0),F=[],_=1;_<k.length;_++)F.push(m(k[_]));var M=k.groups;if(f){var S=[j].concat(F,O,d);void 0!==M&&S.push(M);var P=String(t.apply(void 0,S))}else P=g(j,d,O,F,M,t);O>=R&&(x+=d.slice(R,O)+P,R=O+j.length)}return x+d.slice(R)}];function g(e,t,r,i,u,s){var o=r+e.length,c=i.length,l=f;return void 0!==u&&(u=a(u),l=d),n.call(s,l,(function(n,a){var s;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(o);case"<":s=u[a.slice(1,-1)];break;default:var l=+a;if(0===l)return n;if(l>c){var d=p(l/10);return 0===d?n:d<=c?void 0===i[d-1]?a.charAt(1):i[d-1]+a.charAt(1):n}s=i[l-1]}return void 0===s?"":s}))}}))},cac5:function(e,t,n){"use strict";var r=n("5174"),a=n.n(r);a.a}}]);
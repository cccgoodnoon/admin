(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4bd6a4cc"],{1:function(e,t){},2:function(e,t){},3:function(e,t){},4:function(e,t){},5:function(e,t){},ae33:function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"create",attrs:{id:"#create",model:e.create,rules:e.rules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"负责人",prop:"performer"}},[a("el-input",{model:{value:e.create.performer,callback:function(t){e.$set(e.create,"performer",t)},expression:"create.performer"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务说明",prop:"title"}},[a("el-input",{model:{value:e.create.title,callback:function(t){e.$set(e.create,"title",t)},expression:"create.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务详情",prop:"description"}},[a("el-input",{attrs:{type:"textarea","label-width":"100px"},model:{value:e.create.description,callback:function(t){e.$set(e.create,"description",t)},expression:"create.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开始日期"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.create.begintime,callback:function(t){e.$set(e.create,"begintime",t)},expression:"create.begintime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"截止日期"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.create.endtime,callback:function(t){e.$set(e.create,"endtime",t)},expression:"create.endtime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否完成",prop:"state"}},[a("el-select",{attrs:{placeholder:"请选择完成情况"},model:{value:e.create.state,callback:function(t){e.$set(e.create,"state",t)},expression:"create.state"}},[a("el-option",{attrs:{label:"未完成",value:"0"}}),e._v(" "),a("el-option",{attrs:{label:"已完成",value:"1"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"上传附件",prop:"isFile"}},[a("el-row",[e.isShowPdf?a("el-col",{attrs:{span:8}},[a("div",{staticClass:"avatar-uploader"},[a("img",{attrs:{width:"40",height:"40",src:i("d284")("./"+e.matchType(this.filename)+".png")}}),e._v(" "),a("p",[e._v(e._s(this.filename))])]),e._v(" "),a("div",{staticClass:"mask"},[a("a",{attrs:{href:e.PdfViewer,target:"_blank",title:"点击预览"}},[a("i",{staticClass:"el-icon-zoom-in"})]),e._v(" "),a("a",{attrs:{href:"javascript:;",title:"删除预览"},on:{click:function(t){return e.removeFile("fileone")}}},[a("i",{staticClass:"el-icon-delete"})])])]):e._e(),e._v(" "),e.isShowPdf?e._e():a("el-col",{attrs:{span:8}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"#",multiple:"","file-list":e.create.fileList,"auto-upload":!1}},[a("el-button",{attrs:{slot:"tip",size:"small",type:"primary"},on:{click:e.chooseFile},slot:"tip"},[e._v("选取文件")])],1)],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},r=[],s=(i("28a5"),i("7f7f"),i("a481"),i("ac6a"),i("5df3"),i("96cf"),i("1da1")),n=i("5530"),o=i("2f62"),l=(i("5f87"),i("bc3a")),c=i.n(l),u=i("858e"),f={name:"create",data:function(){return{form:{},create:{description:"",begintime:"",endtime:"",performer:"",title:"",state:"",isFile:0,fileList:[]},rules:{performer:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符"}],title:[{required:!0,message:"请输入任务名",trigger:"blur"},{min:1,max:35,message:"长度在 2 到 35 个字符"}],state:[{required:!0}]},currentPage:0,pageCount:0,fileType:"pdf",isShowPdf:!1,PdfViewer:"javascript:;",PdfViewerTwo:"javascript:;"}},components:{pdf:u["a"]},activated:function(){var e=this.$store.state.duty.fileList;e&&e.length>0&&(this.create.fileList=e)},mounted:function(){this.setFileList([])},computed:{upData:function(){return{body:JSON.stringify(this.form)}}},methods:Object(n["a"])(Object(n["a"])({},Object(o["c"])({setFileList:"duty/setFileList"})),{},{submit:function(){this.createUser()},chooseFile:function(){this.$router.push("/task/attachments/new")},createUser:function(){var e=Object(s["a"])(regeneratorRuntime.mark((function e(){var t,i,a,r,s,n;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.create.fileList,i=t.map((function(e){var t=new FormData;return t.append("file",e.raw),c()({url:"http://202.120.167.50:8088/api/u/fdb/task",method:"post",data:t})})),e.prev=2,e.next=5,Promise.all(i);case 5:for(n in a=e.sent,r=[],Array.isArray(a)&&a.length>0&&a.forEach((function(e){e&&e.data&&e.data.nodeid&&r.push(e.data.nodeid)})),s={},this.create)"fileList"!==n&&(s[n]=this.create[n]);return s.isFile=t.length>0?1:0,s.nodeid=r,e.next=14,c()({url:"http://202.120.167.50:8088/api/admin/task/tasks/new",method:"post",data:s});case 14:a=e.sent,console.log(a),this.$router.push("/task/list"),e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](2),console.log(e.t0);case 22:case"end":return e.stop()}}),e,this,[[2,19]])})));function t(){return e.apply(this,arguments)}return t}(),handleCancel:function(){this.$router.replace("/task/list")},add:function(){this.$refs.upload.submit()},addt:function(){this.$refs.uploadTwo.submit()},upFile:function(e,t,i){console.log(e),console.log(t),console.log(i),console.log(i[0].name),this.filename=i[0].name;var a=this;201==e.status&&(this.$message.success("上传成功"),a.nodeid=e.nodeid,this.create.isFile=1,this.getFileLink("fileone"),this.isShowPdf=!0)},upFileTwo:function(e,t,i){this.filenameTwo=i[0].name;var a=this;201==e.status&&(this.$message.success("上传成功"),console.log(e.nodeid,111111),a.nodeid=e.nodeid,this.getFileLink("filetwo"),this.isShowPdfTwo=!0)},getFileLink:function(e){switch(this.filePath="/api/u/fdb/task/"+this.nodeid+"/content",console.log(this.filePath,"url"),e){case"fileone":this.PdfViewer=this.filePath;break;case"filetwo":this.PdfViewerTwo=this.filePath;break}},removeFile:function(e){switch(e){case"fileone":this.isShowPdf=!1;break;case"filetwo":this.isShowPdfTwo=!1;break}},beforeImageUpload:function(e){console.log(e.size);var t=e.size/1024/1024<20;return console.log(t),t||this.$message.error("上传文件大小不能超过 20MB!"),t},uploadFalse:function(e,t,i){console.log(e),this.$message.error(e.message.slice(1,-2))},handleExceed:function(e,t){this.$message.warning("当前只能选择上传1 个文件")},handleRemove:function(e,t,i){t&&"success"===t.status&&(this.$message.warning("移除当前".concat(e.name,"文件，请重新选择文件上传！")),this.removeFile("fileone"))},loadPdfHandler:function(e){this.currentPage=1},matchType:function(e){var t="",i="";try{var a=e.split(".");t=a[a.length-1]}catch(d){t=""}if(!t)return i=!1,i;var r=["png","jpg","jpeg","gif"];if(i=r.some((function(e){return e===t})),i)return i="image",i;var s=["txt"];if(i=s.some((function(e){return e===t})),i)return i="txt",i;var n=["pdf"];if(i=n.some((function(e){return e===t})),i)return i="pdf",i;var o=["doc"];if(i=o.some((function(e){return e===t})),i)return i="doc",i;var l=["ppt"];if(i=l.some((function(e){return e===t})),i)return i="ppt",i;var c=["zip","rar"];if(i=c.some((function(e){return e===t})),i)return i="zip",i;var u=["mp4"];if(i=u.some((function(e){return e===t})),i)return i="mp4",i;var f=["xls","xlsx"];return i=f.some((function(e){return e===t})),i?(i="xls",i):void 0}})},d=f,p=(i("b2e6"),i("2877")),m=Object(p["a"])(d,a,r,!1,null,null,null);t["default"]=m.exports},b2e6:function(e,t,i){"use strict";var a=i("b73b"),r=i.n(a);r.a},b73b:function(e,t,i){}}]);
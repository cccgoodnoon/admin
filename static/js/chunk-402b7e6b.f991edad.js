(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-402b7e6b"],{"493d":function(e,t,i){"use strict"},"63a1":function(e,t,i){"use strict";i.r(t);var a=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-form",{ref:"update",attrs:{model:e.update,rules:e.updateRules,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"负责人"}},[a("el-input",{model:{value:e.update.performer,callback:function(t){e.$set(e.update,"performer",t)},expression:"update.performer"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务说明"}},[a("el-input",{model:{value:e.update.title,callback:function(t){e.$set(e.update,"title",t)},expression:"update.title"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"任务详情"}},[a("el-input",{attrs:{type:"textarea"},model:{value:e.update.description,callback:function(t){e.$set(e.update,"description",t)},expression:"update.description"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"开始日期"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.update.begintime,callback:function(t){e.$set(e.update,"begintime",t)},expression:"update.begintime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"截止日期"}},[a("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.update.endtime,callback:function(t){e.$set(e.update,"endtime",t)},expression:"update.endtime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"是否完成"}},[a("el-select",{attrs:{prop:"state"},model:{value:e.update.state,callback:function(t){e.$set(e.update,"state",t)},expression:"update.state"}},[a("el-option",{attrs:{label:"已完成",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"未完成",value:"0"}})],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"附件"}},[a("el-row",e._l(this.file_list,(function(t){return a("el-col",{attrs:{span:8}},[a("div",{staticClass:"avatar-uploader"},[a("img",{attrs:{width:"40",height:"40",src:i("d284")("./"+e.matchType(t.filename)+".png")}}),e._v(" "),a("p",[e._v(e._s(t.filename))])]),e._v(" "),a("div",{staticClass:"mask"},[a("a",{attrs:{target:"_blank",title:"点击预览"},on:{click:function(i){return e.previewer(t.uuid)}}},[a("i",{staticClass:"el-icon-zoom-in"})]),e._v(" "),a("a",{attrs:{title:"删除预览"},on:{click:function(i){return e.removeFile(t.uuid)}}},[a("i",{staticClass:"el-icon-delete"})]),e._v(" "),a("a",{attrs:{title:"点击下载"},on:{click:function(i){return e.singeDownloadFile(t.uuid)}}},[a("i",{staticClass:"el-icon-download"})])])])})),1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:8}},[a("el-upload",{staticClass:"upload-demo",attrs:{action:"#",multiple:!0,"file-list":e.update.fileList,"auto-upload":!1}},[a("el-button",{attrs:{slot:"tip",size:"small",type:"primary"},on:{click:e.chooseFile},slot:"tip"},[e._v("选取文件\n            ")])],1)],1)],1)],1),e._v(" "),a("el-form-item",[a("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateUser()}}},[e._v("确 定")])],1)],1)},n=[],r=(i("28a5"),i("7f7f"),i("a481"),i("2f62"),i("5f87")),s=(i("493d"),i("bc3a"),function(e){var t=document.createElement("iframe");t.style.display="none",t.style.height=0,t.src=e,document.body.appendChild(t),setTimeout((function(){t.remove()}),3e5)}),o={name:"edit",data:function(){return{update:{id:"",nodeid:"",description:"",begintime:"",endtime:"",performer:"",title:"",state:"",isFile:0,fileList:[]},uploadFileURL:"",updateRules:{performer:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符"}],title:[{required:!0,message:"请输入任务名",trigger:"blur"},{min:1,max:25}]},isShowPdf:!1,PdfDownload:"javascript:;",file_list:[]}},activated:function(){var e=this.$store.state.duty.fileList;e&&e.length>0&&(this.update.fileList=e),this.getUser()},mounted:function(){this.getUser(),console.log("请求数据")},computed:{upData:function(){return{body:JSON.stringify(this.form)}}},methods:{submitUpload:function(){this.$refs.upload.submit(),this.getActivities()},previewer:function(e){window.open("http://47.111.234.116:8080/api/u/fdb/task/content/"+e,"_blank")},singeDownloadFile:function(e){s("http://47.111.234.116:8080/api/u/fdb/task/"+e)},chooseFile:function(){this.$router.push({path:"/task/attachments/new",query:{nodeid:this.update.nodeid}})},submit:function(){console.log("提交修改",this.update)},reset:function(){this.$refs.create.resetFields()},getUser:function(){var e=this,t=this;r["a"]._gets(t.$route.params.id).then((function(i){t.update=i,t.update.state=String(i["state"]),t.update.nodeid=i["nodeid"],t.uploadFileURL="http://47.111.234.116:8080/api/u/fdb/task/updatefile/"+i["nodeid"],null!=t.update.nodeid&&"None"!=t.update.nodeid&&(e.getFileName(),e.getFileLink("fileone"))}),(function(e){console.log(e)}))},updateUser:function(){var e=this;r["a"]._update(this.$route.params.id,this.update).then((function(t){e.$message({message:"任务修改成功",type:"success"}),e.$router.push("/task/list")}))},handleCancel:function(){this.$router.replace("/task/list")},add:function(){this.$refs.upload.submit()},beforeImageUpload:function(e){var t=e.size/1024/1024<20;return t||this.$message.error("上传文件大小不能超过 20MB!"),t},upFile:function(e,t,i){var a=this;201==e.status&&(this.$message.success("上传成功"),a.update.nodeid=e.nodeid,this.getFileLink("fileone"),this.getFileName())},uploadFalse:function(e,t,i){this.$message.error(e.message.slice(1,-2))},handleExceed:function(e,t){this.$message.warning("当前只能选择上传2 个文件")},handleRemove:function(e,t,i){t&&"success"===t.status&&(this.$message.warning("移除当前".concat(e.name,"文件，请重新选择文件上传！")),this.removeFile("fileone"))},getFileLink:function(e){switch(this.fileDownloadPath="/api/u/fdb/task/"+this.update.nodeid,this.fileViewPath="/api/u/fdb/task/"+this.update.nodeid+"/content",e){case"fileone":this.PdfViewer=this.fileViewPath,this.PdfDownload=this.fileDownloadPath;break;case"filetwo":this.PdfViewerTwo=this.filePath;break}},getFileName:function(){var e=this;r["a"]._getFileName(this.update.nodeid).then((function(t){e.file_list=t,e.isShowPdf="没有附件"!=t}))},removeFile:function(e){var t=this;r["a"]._removeNode(e).then((function(e){t.getUser()}))},matchType:function(e){var t="",i="";try{var a=e.split(".");t=a[a.length-1]}catch(f){t=""}if(!t)return i=!1,i;var n=["png","jpg","jpeg","gif"];if(i=n.some((function(e){return e===t})),i)return i="image",i;var r=["txt"];if(i=r.some((function(e){return e===t})),i)return i="txt",i;var s=["pdf"];if(i=s.some((function(e){return e===t})),i)return i="pdf",i;var o=["doc"];if(i=o.some((function(e){return e===t})),i)return i="doc",i;var l=["ppt"];if(i=l.some((function(e){return e===t})),i)return i="ppt",i;var u=["zip","rar"];if(i=u.some((function(e){return e===t})),i)return i="zip",i;var d=["mp4"];if(i=d.some((function(e){return e===t})),i)return i="mp4",i;var c=["xls","xlsx"];return i=c.some((function(e){return e===t})),i?(i="xls",i):void 0}}},l=o,u=(i("b7a4"),i("2877"));i.d(t,"downloadFile",(function(){return s}));var d=Object(u["a"])(l,a,n,!1,null,null,null);t["default"]=d.exports},"735f":function(e,t,i){},a481:function(e,t,i){"use strict";var a=i("cb7c"),n=i("4bf8"),r=i("9def"),s=i("4588"),o=i("0390"),l=i("5f1b"),u=Math.max,d=Math.min,c=Math.floor,f=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,m=function(e){return void 0===e?e:String(e)};i("214f")("replace",2,(function(e,t,i,h){return[function(a,n){var r=e(this),s=void 0==a?void 0:a[t];return void 0!==s?s.call(a,r,n):i.call(String(r),a,n)},function(e,t){var n=h(i,e,this,t);if(n.done)return n.value;var c=a(e),f=String(this),p="function"===typeof t;p||(t=String(t));var g=c.global;if(g){var b=c.unicode;c.lastIndex=0}var y=[];while(1){var k=l(c,f);if(null===k)break;if(y.push(k),!g)break;var w=String(k[0]);""===w&&(c.lastIndex=o(f,r(c.lastIndex),b))}for(var _="",$=0,x=0;x<y.length;x++){k=y[x];for(var F=String(k[0]),M=u(d(s(k.index),f.length),0),P=[],S=1;S<k.length;S++)P.push(m(k[S]));var U=k.groups;if(p){var C=[F].concat(P,M,f);void 0!==U&&C.push(U);var L=String(t.apply(void 0,C))}else L=v(F,f,M,P,U,t);M>=$&&(_+=f.slice($,M)+L,$=M+F.length)}return _+f.slice($)}];function v(e,t,a,r,s,o){var l=a+e.length,u=r.length,d=p;return void 0!==s&&(s=n(s),d=f),i.call(o,d,(function(i,n){var o;switch(n.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,a);case"'":return t.slice(l);case"<":o=s[n.slice(1,-1)];break;default:var d=+n;if(0===d)return i;if(d>u){var f=c(d/10);return 0===f?i:f<=u?void 0===r[f-1]?n.charAt(1):r[f-1]+n.charAt(1):i}o=r[d-1]}return void 0===o?"":o}))}}))},b7a4:function(e,t,i){"use strict";var a=i("735f"),n=i.n(a);n.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-21759622"],{"0776":function(e,t,i){},"5df3":function(e,t,i){"use strict";var r=i("02f4")(!0);i("01f9")(String,"String",(function(e){this._t=String(e),this._i=0}),(function(){var e,t=this._t,i=this._i;return i>=t.length?{value:void 0,done:!0}:(e=r(t,i),this._i+=e.length,{value:e,done:!1})}))},"70b9":function(e,t,i){"use strict";i.r(t);var r=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-form",{ref:"create",attrs:{id:"#create",model:e.create,rules:e.rules,"label-width":"100px"}},[r("el-form-item",{attrs:{label:"负责人",prop:"performer"}},[r("el-input",{model:{value:e.create.performer,callback:function(t){e.$set(e.create,"performer",t)},expression:"create.performer"}})],1),r("el-form-item",{attrs:{label:"任务说明",prop:"title"}},[r("el-input",{model:{value:e.create.title,callback:function(t){e.$set(e.create,"title",t)},expression:"create.title"}})],1),r("el-form-item",{attrs:{label:"任务详情",prop:"description"}},[r("el-input",{attrs:{type:"textarea","label-width":"100px"},model:{value:e.create.description,callback:function(t){e.$set(e.create,"description",t)},expression:"create.description"}})],1),r("el-form-item",{attrs:{label:"开始日期"}},[r("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.create.begintime,callback:function(t){e.$set(e.create,"begintime",t)},expression:"create.begintime"}})],1),r("el-form-item",{attrs:{label:"截止日期"}},[r("el-date-picker",{attrs:{type:"date",format:"yyyy 年 MM 月 dd 日","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.create.endtime,callback:function(t){e.$set(e.create,"endtime",t)},expression:"create.endtime"}})],1),r("el-form-item",{attrs:{label:"是否完成",prop:"state"}},[r("el-select",{attrs:{placeholder:"请选择完成情况"},model:{value:e.create.state,callback:function(t){e.$set(e.create,"state",t)},expression:"create.state"}},[r("el-option",{attrs:{label:"未完成",value:"0"}}),r("el-option",{attrs:{label:"已完成",value:"1"}})],1)],1),r("el-form-item",{attrs:{label:"任务可见",prop:"categoryid"}},[r("el-select",{attrs:{placeholder:"请选择任务可见范围"},model:{value:e.create.categoryid,callback:function(t){e.$set(e.create,"categoryid",t)},expression:"create.categoryid"}},[r("el-option",{attrs:{label:"全部人可见",value:"0"}}),r("el-option",{attrs:{label:"仅老师可见",value:"1"}})],1)],1),r("el-form-item",{attrs:{label:"上传附件",prop:"isFile"}},[r("el-row",[e.isShowPdf?r("el-col",{attrs:{span:8}},[r("div",{staticClass:"avatar-uploader"},[r("img",{attrs:{width:"40",height:"40",src:i("d284")("./"+e.matchType(this.filename)+".png")}}),r("p",[e._v(e._s(this.filename))])]),r("div",{staticClass:"mask"},[r("a",{attrs:{href:e.PdfViewer,target:"_blank",title:"点击预览"}},[r("i",{staticClass:"el-icon-zoom-in"})]),r("a",{attrs:{href:"javascript:;",title:"删除预览"},on:{click:function(t){return e.removeFile("fileone")}}},[r("i",{staticClass:"el-icon-delete"})])])]):e._e(),e.isShowPdf?e._e():r("el-col",{attrs:{span:8}},[r("el-upload",{staticClass:"upload-demo",attrs:{action:"#",multiple:"","file-list":e.create.fileList,"auto-upload":!1}},[r("el-button",{attrs:{slot:"tip",size:"small",type:"primary"},on:{click:e.chooseFile},slot:"tip"},[e._v("选取文件")])],1)],1)],1)],1),r("el-form-item",[r("el-button",{on:{click:e.handleCancel}},[e._v("取 消")]),r("el-button",{attrs:{type:"primary"},on:{click:e.submit}},[e._v("确 定")])],1)],1)},a=[],n=(i("28a5"),i("7f7f"),i("a481"),i("ac6a"),i("5df3"),i("96cf"),i("1da1")),s=i("5530"),o=i("2f62"),l=(i("5f87"),i("bc3a")),c=i.n(l),u={name:"create",data:function(){return{form:{},create:{description:"",begintime:"",endtime:"",performer:"",title:"",state:"",isFile:0,fileList:[],categoryid:"0"},rules:{performer:[{required:!0,message:"请输入姓名",trigger:"blur"},{min:2,max:15,message:"长度在 2 到 15 个字符"}],title:[{required:!0,message:"请输入任务名",trigger:"blur"},{min:1,max:35,message:"长度在 2 到 35 个字符"}],state:[{required:!0}]},currentPage:0,pageCount:0,fileType:"pdf",isShowPdf:!1,PdfViewer:"javascript:;",PdfViewerTwo:"javascript:;"}},activated:function(){var e=this.$store.state.duty.fileList;e&&e.length>0&&(this.create.fileList=e)},mounted:function(){this.setFileList([])},computed:{upData:function(){return{body:JSON.stringify(this.form)}}},methods:Object(s["a"])(Object(s["a"])({},Object(o["c"])({setFileList:"duty/setFileList"})),{},{submit:function(){this.createUser()},chooseFile:function(){this.$router.push("/task/attachments/new")},createUser:function(){var e=Object(n["a"])(regeneratorRuntime.mark((function e(){var t,i,r,a,n,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=this.create.fileList,i=t.map((function(e){var t=new FormData;return t.append("file",e.raw),c()({url:"/api/u/fdb/task",method:"post",data:t})})),e.prev=2,e.next=5,Promise.all(i);case 5:for(s in r=e.sent,a=[],Array.isArray(r)&&r.length>0&&r.forEach((function(e){e&&e.data&&e.data.nodeid&&a.push(e.data.nodeid)})),n={},this.create)"fileList"!==s&&(n[s]=this.create[s]);return n.isFile=t.length>0?1:0,n.nodeid=a,e.next=14,c()({url:"/api/admin/task/tasks/new",method:"post",data:n});case 14:r=e.sent,console.log(r),this.$router.push("/task/list"),e.next=22;break;case 19:e.prev=19,e.t0=e["catch"](2),console.log(e.t0);case 22:case"end":return e.stop()}}),e,this,[[2,19]])})));function t(){return e.apply(this,arguments)}return t}(),handleCancel:function(){this.$router.replace("/task/list")},add:function(){this.$refs.upload.submit()},addt:function(){this.$refs.uploadTwo.submit()},upFile:function(e,t,i){console.log(e),console.log(t),console.log(i),console.log(i[0].name),this.filename=i[0].name;var r=this;201==e.status&&(this.$message.success("上传成功"),r.nodeid=e.nodeid,this.create.isFile=1,this.getFileLink("fileone"),this.isShowPdf=!0)},upFileTwo:function(e,t,i){this.filenameTwo=i[0].name;var r=this;201==e.status&&(this.$message.success("上传成功"),console.log(e.nodeid,111111),r.nodeid=e.nodeid,this.getFileLink("filetwo"),this.isShowPdfTwo=!0)},getFileLink:function(e){switch(this.filePath="/api/u/fdb/task/"+this.nodeid+"/content",console.log(this.filePath,"url"),e){case"fileone":this.PdfViewer=this.filePath;break;case"filetwo":this.PdfViewerTwo=this.filePath;break}},removeFile:function(e){switch(e){case"fileone":this.isShowPdf=!1;break;case"filetwo":this.isShowPdfTwo=!1;break}},beforeImageUpload:function(e){console.log(e.size);var t=e.size/1024/1024<20;return console.log(t),t||this.$message.error("上传文件大小不能超过 20MB!"),t},uploadFalse:function(e,t,i){console.log(e),this.$message.error(e.message.slice(1,-2))},handleExceed:function(e,t){this.$message.warning("当前只能选择上传1 个文件")},handleRemove:function(e,t,i){t&&"success"===t.status&&(this.$message.warning("移除当前".concat(e.name,"文件，请重新选择文件上传！")),this.removeFile("fileone"))},loadPdfHandler:function(e){this.currentPage=1},matchType:function(e){var t="",i="";try{var r=e.split(".");t=r[r.length-1]}catch(d){t=""}if(!t)return i=!1,i;var a=["png","jpg","jpeg","gif"];if(i=a.some((function(e){return e===t})),i)return i="image",i;var n=["txt"];if(i=n.some((function(e){return e===t})),i)return i="txt",i;var s=["pdf"];if(i=s.some((function(e){return e===t})),i)return i="pdf",i;var o=["doc"];if(i=o.some((function(e){return e===t})),i)return i="doc",i;var l=["ppt"];if(i=l.some((function(e){return e===t})),i)return i="ppt",i;var c=["zip","rar"];if(i=c.some((function(e){return e===t})),i)return i="zip",i;var u=["mp4"];if(i=u.some((function(e){return e===t})),i)return i="mp4",i;var f=["xls","xlsx"];return i=f.some((function(e){return e===t})),i?(i="xls",i):void 0}})},f=u,d=(i("e662"),i("2877")),p=Object(d["a"])(f,r,a,!1,null,null,null);t["default"]=p.exports},a481:function(e,t,i){"use strict";var r=i("cb7c"),a=i("4bf8"),n=i("9def"),s=i("4588"),o=i("0390"),l=i("5f1b"),c=Math.max,u=Math.min,f=Math.floor,d=/\$([$&`']|\d\d?|<[^>]*>)/g,p=/\$([$&`']|\d\d?)/g,h=function(e){return void 0===e?e:String(e)};i("214f")("replace",2,(function(e,t,i,m){return[function(r,a){var n=e(this),s=void 0==r?void 0:r[t];return void 0!==s?s.call(r,n,a):i.call(String(n),r,a)},function(e,t){var a=m(i,e,this,t);if(a.done)return a.value;var f=r(e),d=String(this),p="function"===typeof t;p||(t=String(t));var g=f.global;if(g){var b=f.unicode;f.lastIndex=0}var w=[];while(1){var y=l(f,d);if(null===y)break;if(w.push(y),!g)break;var k=String(y[0]);""===k&&(f.lastIndex=o(d,n(f.lastIndex),b))}for(var x="",$=0,P=0;P<w.length;P++){y=w[P];for(var F=String(y[0]),S=c(u(s(y.index),d.length),0),_=[],L=1;L<y.length;L++)_.push(h(y[L]));var M=y.groups;if(p){var j=[F].concat(_,S,d);void 0!==M&&j.push(M);var T=String(t.apply(void 0,j))}else T=v(F,d,S,_,M,t);S>=$&&(x+=d.slice($,S)+T,$=S+F.length)}return x+d.slice($)}];function v(e,t,r,n,s,o){var l=r+e.length,c=n.length,u=p;return void 0!==s&&(s=a(s),u=d),i.call(o,u,(function(i,a){var o;switch(a.charAt(0)){case"$":return"$";case"&":return e;case"`":return t.slice(0,r);case"'":return t.slice(l);case"<":o=s[a.slice(1,-1)];break;default:var u=+a;if(0===u)return i;if(u>c){var d=f(u/10);return 0===d?i:d<=c?void 0===n[d-1]?a.charAt(1):n[d-1]+a.charAt(1):i}o=n[u-1]}return void 0===o?"":o}))}}))},e662:function(e,t,i){"use strict";var r=i("0776"),a=i.n(r);a.a}}]);
(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3c950907"],{b350:function(e,t,a){"use strict";a.r(t);var i=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("h2",[e._v("教学任务分配")]),e._v(" "),a("div",[a("ul",{staticClass:"fr"},[a("li",[a("el-date-picker",{attrs:{align:"right",type:"date",placeholder:"选择课程开始日期","value-format":"yyyy-MM-dd",format:"yyyy-MM-dd","picker-options":e.pickerOptions,size:"small"},model:{value:e.timeValue,callback:function(t){e.timeValue=t},expression:"timeValue"}}),e._v(" "),a("el-select",{attrs:{placeholder:"请选择课程状态",size:"small"},model:{value:e.objectvalue,callback:function(t){e.objectvalue=t},expression:"objectvalue"}},e._l(e.options,(function(e){return a("el-option",{key:e.objectvalue,attrs:{label:e.label,value:e.objectvalue}})})),1),e._v(" "),a("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.addActivity()}}},[a("i",{staticClass:"el-icon-plus iconss"}),e._v("新增")]),e._v(" "),a("el-button",{attrs:{type:"danger",icon:"delete",disabled:0==e.actiSelected.length,size:"small"},on:{click:function(t){return e.removeActivity()}}},[e._v("移除")])],1)])]),e._v(" "),a("el-row",{staticClass:"row",attrs:{gutter:24}},[a("el-col",{attrs:{offset:1,span:7}},[a("div",[a("span",{staticClass:"subtitle"},[e._v("教师名单")]),e._v(" "),a("el-table",{ref:"memberTable",attrs:{data:e.member.filter((function(t){return!e.msearch||t.firstname.toLowerCase().includes(e.msearch.toLowerCase())})),height:"650","highlight-current-row":"","header-cell-style":{background:"#d6e4f0"}},on:{"row-click":e.handleMember}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"employeeid",label:"工号",width:"75",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"firstname",label:"姓名",width:"120",align:"center"}},[a("template",{slot:"header"},[a("el-input",{attrs:{size:"small",placeholder:"  姓名搜索"},model:{value:e.msearch,callback:function(t){e.msearch=t},expression:"msearch"}})],1)],2),e._v(" "),a("el-table-column",{attrs:{prop:"objectstate",label:"状态",width:"80",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"1"==t.row.objectstate?"success":"info"}},[e._v(e._s(t.row.objectstate))])]}}])}),e._v(" "),a("el-table-column")],1)],1)]),e._v(" "),a("el-col",{attrs:{span:8}},[a("div",[a("span",{staticClass:"subtitle"},[e._v("课程清单")]),e._v(" "),a("el-table",{ref:"courseTable",attrs:{height:"650",data:e.course.filter((function(t){return!e.csearch||t.name.toLowerCase().includes(e.csearch.toLowerCase())})),"highlight-current-row":"","header-cell-style":{background:"#d6e4f0"}},on:{"row-click":e.handleCourse}},[a("el-table-column",{attrs:{prop:"id",label:"ID",width:"60",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"code",label:"课程代号",width:"85",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"课程名称",width:"155",align:"center"}},[a("template",{slot:"header"},[a("el-input",{attrs:{size:"small",placeholder:"  课程名称搜索"},model:{value:e.csearch,callback:function(t){e.csearch=t},expression:"csearch"}})],1)],2),e._v(" "),a("el-table-column",{attrs:{prop:"objectstate",label:"状态",width:"95",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"1"==t.row.objectstate?"success":"info"}},[e._v(e._s(t.row.objectstate))])]}}])})],1)],1)]),e._v(" "),a("el-col",{attrs:{span:7}},[a("div",{staticClass:"righttable"},[a("el-table",{ref:"activityTable",attrs:{height:"650",data:e.activity,"highlight-current-row":"","header-cell-style":{background:"#d6e4f0"}},on:{"selection-change":e.actiTableSelection,"row-click":e.handleActivity}},[a("el-table-column",{attrs:{type:"selection",width:"45"}}),e._v(" "),a("el-table-column",{attrs:{prop:"uuid",label:"ID",width:"40"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(e._s(t.$index+1))]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"code",label:"课程代号",width:"80",align:"center"}}),e._v(" "),a("el-table-column",{attrs:{prop:"name",label:"课程名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"objectstate",label:"状态",width:"110",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-tag",{attrs:{type:"1"==t.row.objectstate?"success":"info"}},[e._v(e._s(e._f("getStateName")(t.row.objectstate)))])]}}])})],1)],1)])],1),e._v(" "),a("el-dialog",{attrs:{title:"修改状态",visible:e.dialogUpdateVisible,"close-on-click-modal":!1,"close-on-press-escape":!1,width:"30%"},on:{"update:visible":function(t){e.dialogUpdateVisible=t}}},[a("el-form",{ref:"update",attrs:{id:"#update",model:e.update,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"课程状态"}},[a("el-select",{attrs:{prop:"state"},model:{value:e.update.state,callback:function(t){e.$set(e.update,"state",t)},expression:"update.state"}},[a("el-option",{attrs:{label:"申请中",value:"1"}}),e._v(" "),a("el-option",{attrs:{label:"已分配",value:"3"}})],1)],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogUpdateVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.updateState}},[e._v("确 定")])],1)],1)],1)},l=[],s=(a("7f7f"),a("2f62"),a("5f87")),c={name:"",filter:{objectstate:""},filters:{getStateName:function(e){var t={1:"申请中",3:"已分配"};return t[e]}},data:function(){return{member:[],course:[],activity:[],checked:null,timeValue:"",course_uuid:"",course_credit:"",uuid:"",member_uuid:"",selected:[],courseSelected:[],actiSelected:[],course_name:"",objectstate:"",id:"",update:{state:""},currentId:"",dialogUpdateVisible:!1,msearch:"",csearch:"",pickerOptions:{shortcuts:[{text:"今天",onClick:function(e){e.$emit("pick",new Date)}},{text:"一周前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-6048e5),e.$emit("pick",t)}},{text:"一个月前",onClick:function(e){var t=new Date;t.setTime(t.getTime()-2592e6),e.$emit("pick",t)}}]},options:[{objectvalue:"1",label:"申请中"},{objectvalue:"3",label:"已分配"}],objectvalue:""}},mounted:function(){this.getMember(),this.getCourse()},methods:{reset:function(){this.$refs.create.resetFields()},actiTableSelection:function(e){if(e.length>1){this.$refs.activityTable.clearSelection();var t=e.pop();this.$refs.activityTable.toggleRowSelection(t,!0),this.actiSelected=t}1==e.length&&(this.$refs.activityTable.toggleRowSelection(e,!1),this.actiSelected=e,this.course_name=e[0].name,this.uuid=e[0].uuid)},handleMember:function(e,t,a){var i=this;this.$refs.memberTable.toggleRowSelection(e),s["a"]._getOM(e.id).then((function(e){i.member_uuid=e[0].uuid,i.getActivity(i.member_uuid)})),this.$refs.memberTable.clearSelection()},handleCourse:function(e,t,a){var i=this;this.$refs.courseTable.toggleRowSelection(e),s["a"]._getOC(e.id).then((function(e){i.course_uuid=e[0].uuid,i.course_credit=e[0].credit}))},handleActivity:function(e,t,a){this.state=e.objectstate,this.update={state:e.objectstate},this.$refs.activityTable.toggleRowSelection(e),this.currentId=e.id,this.dialogUpdateVisible=!0,this.update.state=String(this.state)},getMember:function(){var e=this;s["a"]._getM().then((function(t){e.member=t}),(function(e){console.log(e)}))},getCourse:function(){var e=this;s["a"]._getC().then((function(t){e.course=t}),(function(e){console.log(e)}))},getActivity:function(e){var t=this;s["a"]._getA(this.member_uuid).then((function(e){t.activity=e}),(function(e){console.log(e)}))},addActivity:function(){var e=this;""!=this.course_uuid&&""!=this.member_uuid&&""!=this.timeValue&&""!=this.objectvalue?s["a"]._posta({course_uuid:this.course_uuid,course_credit:this.course_credit,member_uuid:this.member_uuid,timeValue:this.timeValue,objectvalue:this.objectvalue}).then((function(t){e.$message.success("成功为该老师添加一门课！"),e.getCourse(),e.getActivity()}),(function(e){console.log(e)})):""==this.member_uuid?this.$message.warning("请选择一位老师!"):""==this.course_uuid?this.$message.warning("请选择一门课!"):""==this.timeValue?this.$message.warning("请选择课程开始时间!"):""==this.objectvalue&&this.$message.warning("请选择课程状态!")},removeActivity:function(){var e=this;this.$confirm("此操作将删除该老师的 "+this.actiSelected.length+" 门课程, 是否继续?","提示",{type:"warning"}).then((function(){s["a"]._removea(e.uuid).then((function(t){e.$message.success("成功删除了课程!"),e.getActivity()})).catch((function(t){e.$message.error("删除失败!")}))})).catch((function(){e.$message.info("已取消操作!")}))},updateState:function(){var e=this;this.$refs.update.validate((function(t){if(!t)return!1;s["a"]._updatea(e.currentId,e.update).then((function(t){e.$message.success("修改课程状态成功！"),e.dialogUpdateVisible=!1,e.getActivity()})).catch((function(t){var a=t;a instanceof Array?e.$message.error(a[0]["message"]):a instanceof Object&&e.$message.error(a["message"]),e.updateLoading=!1}))}))}}},o=c,n=(a("f5c8"),a("2877")),r=Object(n["a"])(o,i,l,!1,null,null,null);t["default"]=r.exports},f5c8:function(e,t,a){"use strict";var i=a("fe4c"),l=a.n(i);l.a},fe4c:function(e,t,a){}}]);